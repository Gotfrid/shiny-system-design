services:
  ldap_server:
    profiles: [auth]
    env_file: [variables.env]
    extends:
      file: ./authentication/compose.yml
      service: ldap_server
  ldap_admin:
    profiles: [auth]
    env_file: [variables.env]
    extends:
      file: ./authentication/compose.yml
      service: ldap_admin
  shinyproxy:
    profiles: [shinyproxy]
    env_file: [variables.env]
    extends:
      file: ./shinyproxy/compose.yml
      service: shinyproxy
    depends_on:
      ldap_server:
        condition: service_healthy
  database:
    profiles: [monitoring]
    env_file: [variables.env]
    extends:
      file: ./monitoring/compose.yml
      service: database
  grafana:
    profiles: [monitoring]
    env_file: [variables.env]
    attach: false
    extends:
      file: ./monitoring/compose.yml
      service: grafana
  api_dispatcher:
    profiles: [services]
    env_file: [variables.env]
    extends:
      file: ./services/compose.yml
      service: api_dispatcher
  fastapi:
    profiles: [services]
    extends:
      file: ./services/compose.yml
      service: fastapi
  oxygen:
    profiles: [services]
    extends:
      file: ./services/compose.yml
      service: oxygen
  plumber:
    profiles: [services]
    extends:
      file: ./services/compose.yml
      service: plumber
  gin:
    profiles: [services]
    extends:
      file: ./services/compose.yml
      service: gin
  express:
    profiles: [services]
    extends:
      file: ./services/compose.yml
      service: express
  spring:
    profiles: [services]
    extends:
      file: ./services/compose.yml
      service: spring
  kv_database:
    profiles: [cache]
    env_file: [variables.env]
    extends:
      file: ./cache/compose.yml
      service: kv_database

networks:
  ssd-network:
    name: ssd-network
